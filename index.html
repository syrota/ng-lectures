<!doctype html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <!-- use bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <!-- Angular -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
</head>
<body ng-app="app">
<!-- MAX's EDITs -->
<div ng-controller="ShoppingCart as cart">
    <h1>Product</h1>
    <div ng-controller="Product as products">

        <li ng-repeat="brand in products.brands">
            {{ brand.label }}
            <button class="btn btn-primary" ng-click="cart.buy(brand)">Buy!</button>
        </li>
    </div>

    <h1>Shopping Cart</h1>
    <ul>
        <li ng-repeat="value in cart.added track by $index">
            {{ value }}
        </li>
    </ul>
</div>
    <script>

        // TODO add product quantity

        angular.module('app', [])
            .controller('Product', function () {

                this.brands = [
                    { label: 'Samsung' },
                    { label: 'Sony' },
                    { label: 'Dell' },
                    { label: 'Apple' }
                ];
            })
        //TODO display items count instead of repeated elements
            .controller('ShoppingCart', function () {
                this.added = [];
                this.buy = function ( item ) {

                    var newObj = { prod: item.label, num: 1 };

                    // if( this.added.length !== 0 ){

                    //     for (var i = 0; i < this.added.length; i++ ){

                    //         if( this.added[i].prod == item.label ){
                    //               this.added[i].num++;
                    //         } else {
                    //               this.added.push(newObj);
                    //         }

                    //     }
                    // } else {
                    //     this.added.push(newObj);
                    // }

                   var isset = false;

                   for (var i in this.added ){
                       if( this.added[i].prod == item.label ){
                           this.added[i].num++;
                           isset = true;
                       }
                   }

                   if (isset == false) {
                       this.added.push({
                           prod: item.label,
                           num: 1
                       });
                   }

                }.bind(this)            
            })
    </script>
</body>
</html>
